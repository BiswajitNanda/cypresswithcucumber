var should = require('chai').should(),
    totp = require('../totp'),
    tmp = require('tmp'),
    fs = require('fs');

describe('#read_from_file', function() {
  it('Reads string from file', function() {
    var tmpobj = tmp.fileSync();
    var secret_string = "ijewqb5hr3iu67pr"
    fs.writeFileSync(tmpobj.name, secret_string)
    var t = new totp(tmpobj.name, 0)
    t._read_from_file(tmpobj.name).should.equal(secret_string);
  });
});

describe('#get_hotp', function() {
  it('Calculates six digit pin', function() {
    var tmpobj = tmp.fileSync();
    var secret_string = "ijewqb5hr3iu67pr"
    fs.writeFileSync(tmpobj.name, secret_string)
    var steps_since_epoch = 50016680
    var t = new totp(tmpobj.name, steps_since_epoch)
    var expected = 712939
    t.get_hotp().should.equal(expected)
  });
});

