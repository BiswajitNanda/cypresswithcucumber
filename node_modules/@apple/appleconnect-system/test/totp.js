/*jslint node: true */
"use strict";

var assert = require('assert').strict,
    totp = require('../lib/totp'),
    tmp = require('tmp'),
    fs = require('fs');

describe('#read_from_file', function() {
  it('Reads string from file', function() {
    var tmpobj = tmp.fileSync(),
        secret_string = "ijewqb5hr3iu67pr",
        t;
    fs.writeFileSync(tmpobj.name, secret_string);
    t = new totp(tmpobj.name, 0);
    assert.equal(secret_string, t.readFromFile(tmpobj.name));
  });
});

describe('#get_hotp', function() {
  it('Calculates six digit pin', function() {
    var tmpobj = tmp.fileSync(),
        secret_string = "ijewqb5hr3iu67pr",
        steps_since_epoch = 50016680,
        t,
        expected = 712939;
    fs.writeFileSync(tmpobj.name, secret_string);
    t = new totp(tmpobj.name, undefined, steps_since_epoch);
    assert.equal(t.get_hotp(), expected);
  });
});

