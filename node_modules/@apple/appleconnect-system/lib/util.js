var fs = require('fs');
var path = require('path');
// for compatibility with PIE & RIO
var secretsPath = process.env.PLATFORM_BUILD_PATH || process.env.PLATFORM_SECRETS_PATH || 'secrets';

function getSecret(secretName) {
    var val = process.env[secretName];
    if (val) return val;
    try {
        val = fs.readFileSync(path.join(secretsPath, secretName));
        if (val) return val.toString('utf8');
    } catch (e) {
        console.error('Unable to find secret', secretName);
    }
    return undefined;
}

module.exports = {
    getSecret: getSecret
};
